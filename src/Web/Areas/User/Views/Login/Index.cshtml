@model  LoginViewModel
@{
    Layout = "~/Areas/User/Views/Shared/Layout.cshtml";
}
@section Scripts
{
    <script>
        var responseHandle = function(data, resp) {

            if (data.Status)
                $("#invalid-email").css("color", "#268F2A");
            else
                $("#invalid-email").css("color", "#EE5F5F");

            $("#invalid-email").html(data.Messages[0]);
        };
        
        $('#ForgotPassword').on('show', function () {
            $("#Email").val($('.email-login').val());
        });
        
        $(document).keypress(function (e) {
            if (e.which == 13) {
                $('#btn-login').click();
            }
        });
        
        $(function() {
            $('.btn-close').click(function (e) {
                e.preventDefault();
                $("#invalid-email").html('');
                $("#Email").val('');
            });
        });

        
    </script>
}

@section head{
    <style>
        .modal-body p {
            line-height: 25px;
            margin: 0 20px 30px 0;
            text-align: center;
            color: #575757 !important;
        }

        .modal-body label span {
            margin: 0 9px 0 5px;
        }

        #invalid-email {
            margin: 13px 0 10px 56px;
            color: #EE5F5F;
            display: block;
        }
    </style>
}

<!-- Modal Forgot Password -->
<div class="modal fade hide" id="ForgotPassword">
    <div class="modal-dialog">
        <div class="modal-content">
            @using (Html.BeginForm("ForgotPassword", "Login", new { returnUrl = ViewBag.ReturnUrl }, FormMethod.Post, new { @class = "form-vertical login-form" }))
            {
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h4 class="modal-title">Recuperar senha</h4>
                </div>
                <div class="modal-body">
                    <p>Para redefinir sua senha, digite o endereço de e-mail que você usa para fazer login na GTP Transportes</p>
                    <label>
                        <span>Email:</span>
                        <input type="text" id="Email" class="span5" name="email" value="" maxlength="150">
                    </label>
                    <span id="invalid-email"></span>
                </div>

                <div class="modal-footer">
                    <button type="button" class="btn btn-close"
                            data-dismiss="modal">
                        Cancelar
                    </button>
                    <button type="button" data-dgd-click=""
                            data-dgd-condition-callback="digdin.callMessage('Você deve informar o email!');"
                            data-dgd-action="parentFormSubmitAjax"
                            data-dgd-ajax-callback="responseHandle"
                            class="btn blue">
                        Enviar
                    </button>
                </div>
            }
        </div>
    </div>
</div>

<!-- Form Login -->
@using (Html.BeginForm("Login", "Login", new { returnUrl = ViewBag.ReturnUrl }, FormMethod.Post, new { @class = "form-vertical login-form" }))
{
    @Html.AntiForgeryToken()

    <h3 class="form-title">Acesse sua conta</h3>

    <span class="error-msg"></span>

    @Html.ValidationSummary()

    <div class="alert alert-error hide">
        <button class="close" data-dismiss="alert"></button>
        <span>Digite seu email e senha.</span>
    </div>

    <div class="control-group margin-top-10" style="display: inline-block;margin-bottom: 10px !important">
        <!--ie8, ie9 does not support html5 placeholder, so we just show field title for that-->
        <label class="control-label visible-ie8 visible-ie9">Usuário</label>
        <div class="controls">
            <div class="input-icon left">
                <i class="icon-user"></i>
                @Html.TextBoxFor(model => model.Email, null, new { @placeholder = "Email",  @class = "m-wrap placeholder-no-fix email-login" })
            </div>
        </div>
    </div>

    <div class="control-group" style="display: inline-block;margin-bottom: 10px !important">
        <label class="control-label visible-ie8 visible-ie9">Senha</label>
        <div class="controls">
            <div class="input-icon left">
                <i class="icon-lock"></i>
                @Html.PasswordFor(model => model.Password, new { @placeholder = "Senha", @class = "m-wrap placeholder-no-fix" })
            </div>
        </div>
        <div class="clear"></div>
        <div id="forgot-password">
            <a href="#ForgotPassword" data-toggle="modal">Esqueceu a senha?</a>
        </div>
    </div>

    <div class="form-actions">
        <button type="submit" class="btn green pull-right" id="btn-login">
            Login <i class="m-icon-swapright m-icon-white"></i>
        </button>
    </div>
}
